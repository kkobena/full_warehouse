<p-table class="pharma-table" [scrollable]="true" [value]="entites" [showGridlines]="true">
  <ng-template #header>
    <tr class="pharma-table-head">
      <th rowspan="2">Date</th>
      <th rowspan="2">Qté.init</th>
      <th class="text-center" colspan="5">Sortie</th>
      @if (hasDepot()) {
        <th class="text-center" colspan="5">Entrée</th>
      } @else {
        <th class="text-center" colspan="4">Entrée</th>
      }

      <th rowspan="2">Qté.inv</th>
      <th rowspan="2">Ecart.inv</th>
      <th rowspan="2">Stock</th>
    </tr>
    <tr class="pharma-table-head">
      <th>Vente</th>
      <th>Retour.four</th>
      <th>Qté.périmée</th>
      <th>Qté.ajustée</th>
      <th>Qté.décon</th>
      <th>Qté.entrée</th>
      <th>Qté.ajustée</th>
      <th>Qté.décon</th>
      <th>Qté.annullée</th>
      @if (hasDepot()) {
        <th>Retour.dépôt</th>
      }

    </tr>
  </ng-template>
  <ng-template let-columns="columns" let-elRow #body>
    <tr  [pSelectableRow]="elRow">
      <td class="text-center">{{ elRow.mvtDate | date: 'dd/MM/yyyy' }}</td>
      <td class="text-right"><span class="pharma-qty-value">{{ elRow.initStock | number }}</span></td>
      <td class="text-right"><span class="pharma-qty-value">{{ elRow.saleQuantity }}</span></td>
      <td class="text-right"><span class="pharma-qty-value">{{ elRow.retourFournisseurQuantity | number }}</span></td>
      <td class="text-right"><span class="pharma-qty-value">{{ elRow.perimeQuantity | number }}</span></td>
      <td class="text-right"><span class="pharma-qty-value">{{ elRow.ajustementNegatifQuantity | number }}</span></td>
      <td class="text-right"><span class="pharma-qty-value">{{ elRow.deconNegatifQuantity | number }}</span></td>
      <td class="text-right"><span class="pharma-qty-value">{{ elRow.deleveryQuantity | number }}</span></td>
      <td class="text-right"><span class="pharma-qty-value">{{ elRow.ajustementPositifQuantity | number }}</span></td>
      <td class="text-right"><span class="pharma-qty-value">{{ elRow.deconPositifQuantity | number }}</span></td>
      <td class="text-right text-danger"><span class="pharma-qty-value">{{ elRow.canceledQuantity | number }}</span>
      </td>
      @if (hasDepot()) {
        <td class="text-right"><span class="pharma-qty-value">{{ elRow.retourDepot | number }}</span>
        </td>
      }

      <td class="text-right"><span class="pharma-qty-value">{{ elRow.storeInventoryQuantity | number }}</span></td>
      <td class="text-right"><span class="pharma-qty-value">{{ elRow.inventoryGap | number }}</span></td>
      <td class="text-right"><span class="pharma-total">{{ elRow.afterStock | number }}</span></td>
    </tr>
  </ng-template>
  <ng-template #footer>
    @if (entites && entites.length > 0) {
      <tr class="pharma-table-footer">
        <td colspan="2"><span class="pharma-footer-label">TOTAUX</span></td>
        <td class="text-right">
          <span class="pharma-footer-value">{{ saleQuantity | number }}</span>
        </td>
        <td class="text-right">
          <span class="pharma-footer-value">{{ retourFournisseurQuantity | number }}</span>
        </td>
        <td class="text-right">
          <span class="pharma-footer-value">{{ perimeQuantity | number }}</span>
        </td>
        <td class="text-right">
          <span class="pharma-footer-value">{{ ajustementNegatifQuantity | number }}</span>
        </td>
        <td class="text-right">
          <span class="pharma-footer-value">{{ deconNegatifQuantity | number }}</span>
        </td>
        <td class="text-right">
          <span class="pharma-footer-value">{{ deleveryQuantity | number }}</span>
        </td>
        <td class="text-right">
          <span class="pharma-footer-value">{{ ajustementPositifQuantity | number }}</span>
        </td>
        <td class="text-right">
          <span class="pharma-footer-value">{{ deconPositifQuantity | number }}</span>
        </td>
        <td class="text-right text-danger">
          <span class="pharma-footer-value">{{ canceledQuantity | number }}</span>
        </td>
        @if (hasDepot()) {
          <td class="text-right text-danger">
            <span class="pharma-footer-value">{{ retourDepot | number }}</span>
          </td>
        }
        <td colspan="3"></td>
      </tr>
    }
  </ng-template>
  <ng-template let-columns #emptymessage>
    <tr>
      @if (hasDepot()) {
        <td [attr.colspan]="15">Aucune donnée trouvée</td>
      } @else {
        <td [attr.colspan]="14">Aucune donnée trouvée</td>
      }

    </tr>
  </ng-template>
</p-table>
