<jhi-confirm-dialog #confirmDialog></jhi-confirm-dialog>

<div class="container-fluid">
  <div class="row">
    <div class="col-lg-2 col-xl-2 col-xxl-2  col-md-3 col-sm-4">
      <!-- Modern Navigation Sidebar -->
      <div class="pharma-nav-sidebar">
        <div class="pharma-nav-sidebar-card">
          <div class="pharma-nav-sidebar-header">
            <i class="pi pi-box"></i>
            <span>Gestion commandes</span>
          </div>

          <div class="pharma-nav-sidebar-content">
            <div
              #nav="ngbNav"
              (navChange)="onNavChange($event)"
              [(activeId)]="active"
              class="nav flex-column nav-pills"
              ngbNav
              orientation="vertical"
            >
              <ng-container ngbNavItem="SUGGESTIONS">
                <a class="pharma-nav-vertical-link" ngbNavLink>
                  <i class="pi pi-lightbulb"></i>
                  <span>Suggestions</span>
                  <span class="link-arrow">›</span>
                </a>
                <ng-template ngbNavContent>
                  <jhi-suggestion
                    (selectionLength)="updateSelectionLength($event)"
                    [fournisseurId]="selectFournisseurId"
                    [selectedtypeSuggession]="selectedtypeSuggession"
                  ></jhi-suggestion>
                </ng-template>
              </ng-container>

              <ng-container ngbNavItem="REQUESTED">
                <a class="pharma-nav-vertical-link" ngbNavLink>
                  <i class="pi pi-spin pi-spinner"></i>
                  <span>Commande en cours</span>
                  <span class="link-arrow">›</span>
                </a>
                <ng-template ngbNavContent>
                  <jhi-commande-en-cours
                    (selectionLength)="updateSelectionLength($event)"
                    [searchCommande]="searchCommande"
                    [search]="search"
                  ></jhi-commande-en-cours>
                </ng-template>
              </ng-container>

              <ng-container ngbNavItem="BONS_EN_COURS">
                <a class="pharma-nav-vertical-link" ngbNavLink>
                  <i class="pi pi-file"></i>
                  <span>Bons en cours</span>
                  <span class="link-arrow">›</span>
                </a>
                <ng-template ngbNavContent>
                  <jhi-bon-en-cours [search]="search"></jhi-bon-en-cours>
                </ng-template>
              </ng-container>

              <ng-container ngbNavItem="LIST_BONS">
                <a class="pharma-nav-vertical-link" ngbNavLink>
                  <i class="pi pi-list"></i>
                  <span>Liste des bons</span>
                  <span class="link-arrow">›</span>
                </a>
                <ng-template ngbNavContent>
                  <jhi-list-bons [search]="search"></jhi-list-bons>
                </ng-template>
              </ng-container>
            </div>
          </div>
        </div>
      </div>

    </div>
    <div class="col-lg-10 col-xl-10 col-xxl-10  col-md-9 col-sm-8">
      <p-panel header="Menu commandes">
        <p-toolbar>
          <ng-template #start>
            @if (active === 'REQUESTED') {
              <p-iconfield>
                <p-inputicon class="pi pi-search" />
                <input
                  class="ms-1"
                  (keyup.enter)="onSearch()"
                  [(ngModel)]="searchCommande"
                  pInputText
                  placeholder="Recherche sur la commande"
                  type="text"
                /></p-iconfield
              >
            }
            <p-iconfield>
              <p-inputicon class="pi pi-search" />
              <input
                class="ms-1"
                (keyup.enter)="onSearch()"
                [(ngModel)]="search"
                pInputText
                placeholder="Taper pour rechercher"
                type="text"
              /></p-iconfield
            >
            @if (active === 'SUGGESTIONS') {
              <p-select
                class="ms-1"
                (onChange)="onTypeSuggestionChange($event)"
                [filter]="false"
                [showClear]="true"
                [fluid]="true"
                [options]="typeSuggessions"
                optionLabel="label"
                optionValue="value"
                placeholder="Séléctionner un type de suggestion "
              >
              </p-select
              >
              <p-select
                (onChange)="onFournisseurChange($event)"
                [filter]="false"
                class="ms-1"
                [fluid]="true"
                [showClear]="true"
                [options]="fournisseurs"
                optionLabel="libelle"
                optionValue="id"
                placeholder="Séléctionner un fournisseur "
              >
              </p-select>
            }

          </ng-template>
          <ng-template #end>
            <span class="p-buttonset">
              <p-button
                class="ms-1"
                (click)="onSearch()"
                [raised]="true"
                icon="pi pi-search"
                label="Rechercher"
                severity="info"
                type="button"
              ></p-button>

              @if (active === 'REQUESTED') {
                <p-button
                  class="ms-1"
                  (click)="onShowNewCommandeDialog()"
                  [raised]="true"
                  icon="pi pi-upload"
                  label="Importation"
                  severity="help"
                  type="button"
                ></p-button>
                <p-button
                  (click)="onCreatNewCommande()"
                  [raised]="true"
                  icon="pi pi-plus"
                  label="Nouvelle commande"
                  severity="primary"
                  type="button"
                  class="ms-1"
                ></p-button>
              }
              @if ((active === 'REQUESTED' || active === 'SUGGESTIONS') && selectionLength > 1) {
                <p-button
                  class="ms-1"
                  (click)="fusionner()"
                  icon="pi pi-copy"
                  label="Fusionner"
                  [raised]="true"
                  severity="warn"

                  type="button"
                ></p-button>
              }
              @if (selectionLength > 0 && active !== 'RECEIVED') {
                <p-button
                  class="ms-1"
                  (click)="confirmDeleteSelectedRows()"
                  icon="pi pi-times"
                  label="Supprimer"
                  [raised]="true"
                  severity="danger"
                  type="button"
                >
                </p-button>
              }
            </span>
          </ng-template>
        </p-toolbar>
        <div class="mt-2" [ngbNavOutlet]="nav"></div>
      </p-panel>
    </div>
  </div>

</div>


