<div class="modal-header">
  <h4 class="modal-title">{{ title }}</h4>
  <button (click)="cancel()" class="btn-close" data-dismiss="modal" type="button"></button>
</div>

<form (ngSubmit)="save()" [formGroup]="editForm" name="editForm" novalidate role="form">
  <div class="modal-body">
    <div class="card-grid-2col">
      <!-- Section 1: Champs Obligatoires -->
      <p-card>
        <ng-template #header>
          <div class="section-header section-header-required">
            <i class="pi pi-exclamation-circle"></i>
            <span>Champs Obligatoires</span>
          </div>
        </ng-template>

        <div class="form-grid-compact">
          <!-- Nom -->
          <div class="form-field form-field-full">
            <label for="field_firstName">Nom <span class="required">*</span></label>
            <input
              #firstName
              pInputText
              id="field_firstName"
              formControlName="firstName"
              class="w-full"
              autocomplete="off"
              autofocus
              [class.ng-invalid]="editForm.get('firstName')?.invalid && editForm.get('firstName')?.touched"
            />
            @if (editForm.get('firstName')?.invalid && editForm.get('firstName')?.touched) {
              @if (editForm.get('firstName')?.errors?.required) {
                <small class="p-error" jhiTranslate="entity.validation.required">Ce champ est obligatoire</small>
              }
            }
          </div>

          <!-- Prénom(s) -->
          <div class="form-field form-field-full">
            <label for="field_lastName">Prénom(s) <span class="required">*</span></label>
            <input
              pInputText
              id="field_lastName"
              formControlName="lastName"
              class="w-full"
              autocomplete="off"
              [class.ng-invalid]="editForm.get('lastName')?.invalid && editForm.get('lastName')?.touched"
            />
            @if (editForm.get('lastName')?.invalid && editForm.get('lastName')?.touched) {
              @if (editForm.get('lastName')?.errors?.required) {
                <small class="p-error" jhiTranslate="entity.validation.required">Ce champ est obligatoire</small>
              }
            }
          </div>

          <!-- Numéro assuré -->
          <div class="form-field form-field-full">
            <label for="field_numAyantDroit">Numéro assuré <span class="required">*</span></label>
            <input
              pInputText
              pKeyFilter="alphanum"
              id="field_numAyantDroit"
              formControlName="numAyantDroit"
              class="w-full"
              autocomplete="off"
              [class.ng-invalid]="editForm.get('numAyantDroit')?.invalid && editForm.get('numAyantDroit')?.touched"
            />
            @if (editForm.get('numAyantDroit')?.invalid && editForm.get('numAyantDroit')?.touched) {
              @if (editForm.get('numAyantDroit')?.errors?.required) {
                <small class="p-error" jhiTranslate="entity.validation.required">Ce champ est obligatoire</small>
              }
            }
          </div>
        </div>
      </p-card>

      <!-- Section 2: Informations Complémentaires -->
      <p-card>
        <ng-template #header>
          <div class="section-header">
            <i class="pi pi-user"></i>
            <span>Informations Complémentaires</span>
          </div>
        </ng-template>

        <div class="form-grid-compact">
          <!-- Date de naissance -->
          <div class="form-field form-field-full">
            @let datNaiss = editForm.get('datNaiss');
            <label for="field_datNaiss">Date de naissance</label>
            <input
              pInputText
              jhiDateNaiss
              id="field_datNaiss"
              formControlName="datNaiss"
              placeholder="jj/mm/aaaa"
              class="w-full"
              [class.ng-invalid]="datNaiss?.invalid && datNaiss?.touched"
            />
            @if (datNaiss?.invalid && datNaiss?.touched) {
              @let errors = datNaiss?.errors;
              @if (errors?.invalidDate || errors?.outOfRange) {
                <small class="p-error">Veuillez saisir une date valide</small>
              }
            }
          </div>

          <!-- Sexe -->
          <div class="form-field form-field-full">
            <label>Sexe</label>
            <div class="radio-group">
              <p-radioButton formControlName="sexe" id="masculin" inputId="masculin" name="sexe" value="M"></p-radioButton>
              <label for="masculin" class="radio-label">Masculin</label>
              <p-radioButton formControlName="sexe" id="feminin" inputId="feminin" name="sexe" value="F"></p-radioButton>
              <label for="feminin" class="radio-label">Feminin</label>
            </div>
          </div>
        </div>
      </p-card>
    </div>
  </div>

  <div class="form-actions-compact">
    <p-button
      (click)="cancel()"
      [raised]="true"
      class="mr-2"
      icon="pi pi-times"
      label="Annuler"
      severity="secondary"
      type="button"
    ></p-button>
    <p-button
      [disabled]="editForm.invalid || isSaving || !isValid"
      [raised]="true"
      icon="pi pi-check"
      label="Enregistrer"
      severity="success"
      type="submit"
    ></p-button>
  </div>
</form>
<jhi-toast-alert #alert></jhi-toast-alert>
