<div class="modal-header">
  <h4 class="modal-title">{{ header }}</h4>
  <button (click)="cancel()" class="btn-close" data-dismiss="modal" type="button">
    &times;
  </button>
</div>

<div class="modal-body form-client-step" id="modal">
  <p-card>
    <p-stepper [linear]="true" [value]="activeStep">
      <p-step-list>
        <p-step [value]="1">Infos Assuré</p-step>
        @if (!assureFormStepService.isEdition() && typeAssure === 'ASSURANCE') {
          <p-step [value]="2">Infos Ayant-droit</p-step>
        }
      </p-step-list>
      <p-step-panels>
        <p-step-panel [value]="1">
          <ng-template #content let-activateCallback="activateCallback">
            <jhi-assure-step #assureStep></jhi-assure-step>
            <div class="d-flex justify-content-center pt-2">
              @if (assureStepComponent()?.editForm.valid) {
                <p-button
                  (onClick)="save()"
                  icon="pi pi-check"
                  iconPos="right"
                  [disabled]="isSaving"
                  [loading]="isSaving"
                  label="Enregister"
                  severity="success"
                  styleClass="mx-1"
                />
                @if (commonService.categorieTiersPayant() === 'ASSURANCE') {
                  <p-button (onClick)="onGoAyantDroit(2)" icon="pi pi-arrow-right"
                            severity="info" label="Suivant" />
                }
              }
            </div>
          </ng-template>
        </p-step-panel>
        @if (!assureFormStepService.isEdition() && typeAssure === 'ASSURANCE') {
          <p-step-panel [value]="2">
            <ng-template let-activateCallback="activateCallback" let-prevCallback="prevCallback"
                         #content>
              <jhi-ayant-droit-step #ayantDroitStep></jhi-ayant-droit-step>
              <div class="d-flex justify-content-center pt-2">
                <p-button (onClick)="onGoBackFromAyantDroit(1)" icon="pi pi-arrow-left"
                          label="Précedent" severity="info" />
                @if (ayantDroitStepComponent()?.isValidForm()) {
                  <p-button
                    (onClick)="save()"
                    icon="pi pi-check"
                    [disabled]="isSaving"
                    [loading]="isSaving"
                    severity="success"
                    label="Enregister"
                    class="mx-1"
                  />
                }
              </div>
            </ng-template>
          </p-step-panel>
        }
      </p-step-panels>
    </p-stepper>
  </p-card>
</div>
<div class="modal-footer modal-footer-step">
  <p-button (click)="cancel()" [raised]="true" data-dismiss="modal" icon="pi pi-times"
            label="Annuler"
            severity="secondary" type="button"></p-button>
</div>
<jhi-toast-alert #alert></jhi-toast-alert>
