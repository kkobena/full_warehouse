@if (rowData?.length > 0) {
  <p-table
    [paginator]="true"
    [rowsPerPageOptions]="[5, 10, 15, 20, 30, 50]"
    [rows]="itemsPerPage"
    [value]="rowData"
    dataKey="id"
    [stripedRows]="true"
  >
    <ng-template #header>
      <tr>
        <th style="width: 3%"></th>
        <th>Opérateur</th>
        <th>Date opération</th>
        <th>Nombre de produits</th>
        <th>Commentaire</th>
        <th>Magasin de stockage</th>
        <th style="width: 7%"></th>
      </tr>
    </ng-template>
    <ng-template let-ajust let-expanded="expanded" #body>
      <tr>
        <td>
          <p-button
            [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
            [pRowToggler]="ajust"
            [rounded]="true"
            [text]="true"
            type="button"
          />
        </td>
        <td>{{ ajust.userFullName }}</td>
        <td>{{ ajust.dateMtv | date: 'dd/MM/yy HH:mm' }}</td>
        <td class="text-right">{{ ajust.ajustements.length }}</td>
        <td>{{ ajust.commentaire }}</td>
        <td>{{ ajust.storageLibelle }}</td>
        <td class="text-right">
          <div class="btn-group">
            <p-button
              (click)="exportPdf(ajust)"
              class="ml-sm-1"
              rounded="true"
              [text]="true"
              icon="pi pi-file-pdf"
              severity="secondary"
              pTooltip="Imprimer"
            ></p-button>
          </div>
        </td>
      </tr>
    </ng-template>
    <ng-template let-elRow #expandedrow>
      <tr>
        <td colspan="7">
          <p-card>
            <table class="table table-secondary table-striped-columns table-bordered">
              <thead>
              <tr class="table-secondary">
                <th colspan="7">DETAILS</th>
              </tr>
              <tr>
                <th style="width: 2%">#</th>
                <th>Code cip</th>
                <th>Libellé</th>
                <th>Quantité ajustée</th>
                <th>Stock avant</th>
                <th>Stock final</th>
                <th>Motif</th>
              </tr>
              </thead>
              <tbody>
                @for (ajustement of elRow.ajustements; track ajustement.id; let rowIndex = $index) {
                  <tr>
                    <td style="text-align: left">{{ rowIndex + 1 }}</td>
                    <td>{{ ajustement.codeCip }}</td>
                    <td>{{ ajustement.produitLibelle }}</td>
                    <td class="text-right ">{{ ajustement.qtyMvt | number }}</td>
                    <td class="text-right amount-td-column">{{ ajustement.stockBefore | number }}
                    </td>
                    <td class="text-right amount-td-column">{{ ajustement.stockAfter | number }}
                    </td>
                    <td>{{ ajustement.motifAjustementLibelle }}</td>
                  </tr>
                }
              </tbody>
            </table>
          </p-card>

        </td>
      </tr>
    </ng-template>
  </p-table>
} @else {
  <div class="alert alert-warning" id="no-result">
    <span>{{ 'warehouseApp.ajustement.home.notFound' | translate }}</span>
  </div>
}
