
<div class="container">
  <div class="justify-content-center">
    <p-panel>
      <ng-template #header>
        <h4>Liste des utilisateurs</h4>
      </ng-template>
      <ng-template #content>
        <p-toolbar>
          <div class="p-toolbar-group-left p-md-7">
          <!--  <p-iconfield>
              <p-inputicon styleClass="pi pi-search" />
              <input (keyup.enter)="search($event)" pInputText placeholder="Taper pour rechercher" style="width: 98%" type="text" />
            </p-iconfield> -->
          </div>
          <div class="p-toolbar-group-right">

            <p-button [routerLink]="['./new']" icon="pi pi-users" label="Créer un nouvel utilisateur" raised="true" severity="primary">
            </p-button>
          </div>
        </p-toolbar>
          @if (users()) {
            <div class="mt-2">
              <table class="table table-striped">
                <thead>
                <tr >
                  <th scope="col" >
                    <span jhiTranslate="userManagement.login">Login</span>

                  </th>
                  <th scope="col" >
                    <span>Nom</span>

                  </th>
                  <th scope="col" >
                    <span>Prénom</span>

                  </th>
                  <th scope="col"></th>
                  <th scope="col"><span jhiTranslate="userManagement.profiles">Droits</span></th>
                  <th scope="col" >
                    <span jhiTranslate="userManagement.createdDate">Créé le</span>

                  </th>
                  <th scope="col" >
                    <span jhiTranslate="userManagement.lastModifiedBy">Modifié par</span>

                  </th>
                  <th scope="col" >
                    <span jhiTranslate="userManagement.lastModifiedDate">Modifié le</span>

                  </th>
                  <th scope="col" >
                    <span jhiTranslate="userManagement.email">Email</span>

                  </th>
                  <th scope="col"></th>
                </tr>
                </thead>
                <tbody>
                  @for (user of users(); track trackIdentity) {
                    <tr>
                      <td>
                        <a [routerLink]="['./', user.login, 'view']">{{ user.login }}</a>
                      </td>

                      <td>{{ user.firstName }}</td>
                      <td>{{ user.lastName }}</td>
                      <td>
                        @if (!user.activated) {
                          <button class="btn btn-danger btn-sm" (click)="setActive(user, true)" jhiTranslate="userManagement.deactivated">
                            Désactivé
                          </button>
                        } @else {
                          <button
                            class="btn btn-success btn-sm"
                            (click)="setActive(user, false)"
                            [disabled]="!currentAccount() || currentAccount()?.login === user.login"
                            jhiTranslate="userManagement.activated"
                          >
                            Activé
                          </button>
                        }
                      </td>
                      <td>
                        @for (authority of user.authorities; track $index) {
                          <div>
                            <span class="badge bg-info">{{ authority }}</span>
                          </div>
                        }
                      </td>
                      <td>{{ user.createdDate | date: 'dd/MM/yy HH:mm' }}</td>
                      <td>{{ user.lastModifiedBy }}</td>
                      <td>{{ user.lastModifiedDate | date: 'dd/MM/yy HH:mm' }}</td>
                      <td>{{ user.email }}</td>
                      <td class="text-end">
                        <div class="btn-group">
                          <p-button [rounded]="true" [text]="true"  [routerLink]="['./', user.login, 'view']" pTooltip="Voir détails" icon="pi pi-eye" severity="info">
                          </p-button>

                          <p-button [rounded]="true" [text]="true"
                                    [routerLink]="['./', user.login, 'edit']"
                            queryParamsHandling="merge"
                           severity="primary" icon="pi pi-pencil" pTooltip="Editer" type="button"
                          >
                          </p-button>

                          <p-button [rounded]="true" [text]="true"
                                  type="button"
                            (click)="deleteUser(user)" icon="pi pi-trash" pTooltip="Supprimer"
                           severity="danger"
                            [disabled]="!currentAccount() || currentAccount()?.login === user.login"
                          >
                          </p-button>
                        </div>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>

            <div>
              <div class="d-flex justify-content-center">
                <jhi-item-count [params]="{ page: page, totalItems: totalItems(), itemsPerPage: itemsPerPage }"></jhi-item-count>
              </div>

              <div class="d-flex justify-content-center">
                <ngb-pagination
                  [collectionSize]="totalItems()"
                  [(page)]="page"
                  [pageSize]="itemsPerPage"
                  [maxSize]="5"
                  [rotate]="true"
                  [boundaryLinks]="true"
                  (pageChange)="transition()"
                ></ngb-pagination>
              </div>
            </div>
          }

      </ng-template>
    </p-panel></div>
</div>




