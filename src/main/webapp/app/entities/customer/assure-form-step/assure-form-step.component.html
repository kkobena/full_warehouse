<div class="modal-header">
  <h4 class="modal-title">{{ header }}</h4>
  <button (click)="cancel()" class="btn-close" data-dismiss="modal" type="button">
    &times;
  </button>
</div>

<div class="modal-body form-client-step" id="modal">
  <p-card>
    <p-stepper [linear]="true" [value]="activeStep">
      <p-step-list>
        <p-step [value]="1">Infos Assuré</p-step>
        @if (!assureFormStepService.isEdition() && typeAssure === 'ASSURANCE') {
          <p-step [value]="2">Infos Ayant-droit</p-step>
        }
      </p-step-list>
      <p-step-panels>
        <p-step-panel [value]="1">
          <ng-template #content let-activateCallback="activateCallback">
            <jhi-assure-step #assureStep></jhi-assure-step>
          </ng-template>
        </p-step-panel>
        @if (!assureFormStepService.isEdition() && typeAssure === 'ASSURANCE') {
          <p-step-panel [value]="2">
            <ng-template let-activateCallback="activateCallback" let-prevCallback="prevCallback"
                         #content>
              <jhi-ayant-droit-step #ayantDroitStep></jhi-ayant-droit-step>
            </ng-template>
          </p-step-panel>
        }
      </p-step-panels>
    </p-stepper>
  </p-card>
</div>

<div class="form-actions-compact">
  @if (activeStep === 1) {
    <p-button
      label="Annuler"
      icon="pi pi-times"
      severity="secondary"
      [text]="true"
      type="button"
      (click)="cancel()">
    </p-button>
    @if (assureStepComponent()?.editForm.valid) {
      <p-button
        label="Enregistrer"
        icon="pi pi-check"
        severity="primary"
        type="button"
        [disabled]="isSaving"
        [loading]="isSaving"
        (onClick)="save()">
      </p-button>
      @if (commonService.categorieTiersPayant() === 'ASSURANCE') {
        <p-button
          label="Suivant"
          icon="pi pi-arrow-right"
          iconPos="right"
          severity="info"
          type="button"
          (onClick)="onGoAyantDroit(2)">
        </p-button>
      }
    }
  }
  @if (activeStep === 2) {
    <p-button
      label="Précédent"
      icon="pi pi-arrow-left"
      severity="secondary"
      [text]="true"
      type="button"
      (onClick)="onGoBackFromAyantDroit(1)">
    </p-button>
    @if (ayantDroitStepComponent()?.isValidForm()) {
      <p-button
        label="Enregistrer"
        icon="pi pi-check"
        severity="primary"
        type="button"
        [disabled]="isSaving"
        [loading]="isSaving"
        (onClick)="save()">
      </p-button>
    }
  }
</div>
<jhi-toast-alert #alert></jhi-toast-alert>
