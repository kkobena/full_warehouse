@if (rowData?.length > 0) {
  <p-table
    [paginator]="true"
    [rowsPerPageOptions]="[5, 10, 15, 20, 30, 50]"
    [rows]="itemsPerPage"
    [value]="rowData"
    dataKey="id"
    [stripedRows]="true"
    class="pharma-table"
  >
    <ng-template #header>
      <tr class="pharma-table-head">
        <th style="width: 3%"></th>
        <th>Opérateur</th>
        <th>Date opération</th>
        <th>Nombre de produits</th>
        <th>Commentaire</th>
        <th>Magasin de stockage</th>
        <th style="width: 7%"></th>
      </tr>
    </ng-template>
    <ng-template let-ajust let-expanded="expanded" #body>
      <tr>
        <td>
          <p-button
            [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
            [pRowToggler]="ajust"
            [rounded]="true"
            [text]="true"
            type="button"
          />
        </td>
        <td><span class="pharma-entity-name">{{ ajust.userFullName }}</span></td>
        <td><span class="pharma-entity-name">{{ ajust.dateMtv | date: 'dd/MM/yy HH:mm' }}</span></td>
        <td class="text-right"><span class="pharma-qty-value">{{ ajust.ajustements.length }}</span></td>
        <td><span class="pharma-entity-name">{{ ajust.commentaire }}</span></td>
        <td><span class="pharma-entity-name">{{ ajust.storageLibelle }}</span></td>
        <td class="text-right">
          <div class="btn-group">
            <p-button
              (click)="exportPdf(ajust)"
              class="ml-sm-1"
              rounded="true"
              [text]="true"
              icon="pi pi-file-pdf"
              severity="secondary"
              pTooltip="Imprimer"
            ></p-button>
          </div>
        </td>
      </tr>
    </ng-template>
    <ng-template let-elRow #expandedrow>
      <tr class="pharma-expanded-row">
        <td colspan="7">
          <div class="pharma-sub-table-container">
            <div class="pharma-sub-table-header">
              <i class="pi pi-list"></i>
              <span>DETAILS</span>
            </div>
            <div class="pharma-sub-table-body">
              <table class="table table-striped-columns table-bordered">
                <thead>
                <tr class="pharma-table-head">
                  <th style="width: 2%">#</th>
                  <th>Code cip</th>
                  <th>Libellé</th>
                  <th>Quantité ajustée</th>
                  <th>Stock avant</th>
                  <th>Stock final</th>
                  <th>Motif</th>
                </tr>
                </thead>
                <tbody>
                  @for (ajustement of elRow.ajustements; track ajustement.id; let rowIndex = $index) {
                    <tr>
                      <td style="text-align: left"><span class="pharma-row-number">{{ rowIndex + 1 }}</span></td>
                      <td><span class="pharma-code">{{ ajustement.codeCip }}</span></td>
                      <td><span class="pharma-entity-name">{{ ajustement.produitLibelle }}</span></td>
                      <td class="text-right"><span class="pharma-qty-value">{{ ajustement.qtyMvt | number }}</span></td>
                      <td class="text-right"><span class="pharma-qty-value">{{ ajustement.stockBefore | number }}</span></td>
                      <td class="text-right"><span class="pharma-qty-value">{{ ajustement.stockAfter | number }}</span></td>
                      <td><span class="pharma-entity-name">{{ ajustement.motifAjustementLibelle }}</span></td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
} @else {
  <div class="alert alert-warning" id="no-result">
    <span>{{ 'warehouseApp.ajustement.home.notFound' | translate }}</span>
  </div>
}
