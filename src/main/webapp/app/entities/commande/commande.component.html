<ngx-spinner [fullScreen]="false" bdColor="rgba(255,255,255,0.5)" color="#f13151"
             name="gestion-commande-spinner" size="medium"
             type="timer"></ngx-spinner>
<p-confirmDialog #deleteCommande [baseZIndex]="10000" [style]="{width: '40vw'}"
                 key="deleteCommande">
</p-confirmDialog>
<p-dialog [(visible)]="fileDialog" [focusOnShow]="false" [modal]="true"
          [style]="{width: '50vw'}" header="Importer un fichier">
  <div class="ui-g form-group">
    <p-fileupload (uploadHandler)="onImporterReponseCommande($event)" [customUpload]="true"
                  accept=".csv,.xls,.xlsx"
                  cancelLabel="Annuler"
                  chooseLabel="Importer un fichier" name="importcsv"
                  uploadLabel="Enrégistrer">
    </p-fileupload>
  </div>
  <p-footer>
    <button (click)="cancel()" class="p-button-danger mr-2 p-button-raised" icon="pi pi-times"
            label="Annuler"
            pButton
            pRipple type="button"></button>

  </p-footer>
</p-dialog>

<p-panel header="Menu commandes" styleClass="main-panel">
  <div class="row commande-gestion">
    <div class="col-2 col-md-2 col-sm-2">

      <p-card>
        <div #nav="ngbNav" (navChange)="onNavChange($event)" [(activeId)]="active"
             class="nav flex-column nav-pills " ngbNav
             orientation="vertical">
          <ng-container ngbNavItem="REQUESTED">
            <a class="flex-sm-fill nav-link " ngbNavLink>Commande en cours</a>
            <ng-template ngbNavContent>
              <jhi-commande-en-cours (selectionLength)="updateSelectionLength($event)"
                                     [searchCommande]="searchCommande"
                                     [search]="search"></jhi-commande-en-cours>
            </ng-template>
          </ng-container>
          <ng-container ngbNavItem="PASSED">
            <a class="flex-sm-fill nav-link " ngbNavLink>Commande passées</a>
            <ng-template ngbNavContent>
              <jhi-commande-passes (selectionLength)="updateSelectionLength($event)"
                                   [searchCommande]="searchCommande"
                                   [search]="search"></jhi-commande-passes>
            </ng-template>
          </ng-container>
          <ng-container ngbNavItem="RECEIVED">
            <a class="flex-sm-fill nav-link" ngbNavLink>Commande reçues</a>
            <ng-template ngbNavContent>
              <jhi-commande-recus [searchByRef]="searchCommande"
                                  [search]="search"></jhi-commande-recus>
            </ng-template>
          </ng-container>
        </div>
      </p-card>

    </div>

    <div class="col-10 col-md-10 col-sm-10 row">
      <div>
        <p-toolbar>
          <div class="p-toolbar-group-left commande" style="width: 50%;">
            <div class="row" style="width: 100%;">

              <div class="col-md-6">

                <input (keyup.enter)="onSearch()" [(ngModel)]="searchCommande" pInputText
                       placeholder="Recherche sur la commande"
                       style="width: 100%;" type="text">

              </div>
              <div class="col-md-6">

                <input (keyup.enter)="onSearch()" [(ngModel)]="search" pInputText
                       placeholder="Recherche sur les produits"
                       style="width: 100%;" type="text">

              </div>


            </div>

          </div>
          <div class="p-toolbar-group-right">
                 <span class="p-buttonset">
                <button (click)="onSearch()"
                        [raised]="true"
                        pButton pButtonIcon="pi pi-search"
                        pButtonLabel="Rechercher"
                        pRipple
                        severity="info"
                        type="button"></button>
                <button (click)="onShowNewCommandeDialog()"
                        [raised]="true" pButton pButtonIcon="pi pi-upload"
                        pButtonLabel="Importation"
                        pRipple
                        severity="help" type="button"></button>
   <button (click)="onCreatNewCommande()"
           [raised]="true"
           pButton
           pButtonIcon="pi pi-plus"
           pButtonLabel="Nouvelle commande"
           pRipple
           severity="success" type="button"></button>
                   @if (active === 'REQUESTED' && selectionLength > 1) {
                     <button (click)="fusionner()"
                             pButtonIcon="pi pi-copy"
                             pButtonLabel="Fusionner"
                             [raised]="true"
                             severity="warn"
                             pButton
                             pRipple type="button">

                </button>

                   }
                   @if (selectionLength > 0) {
                     <button
                       pButton
                       pButtonIcon="pi pi-times"
                       pButtonLabel="Supprimer"
                       [raised]="true"
                       severity="danger"
                       pRipple type="button">

                </button>
                   }

                 </span>
          </div>
        </p-toolbar>
      </div>


      <div [ngbNavOutlet]="nav">

      </div>

    </div>
  </div>
</p-panel>




